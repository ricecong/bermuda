<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Bermuda APIs</title>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
  <style>
    html, body {
      font-family: 'Montserrat', sans-serif;
    }

    .api-url {
      font-family: 'Consolas';
      background-color: #f2f2f2;
    }

    .upper {
      text-transform: uppercase;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-light bg-info">
    <div class="container">
      <span class="navbar-brand mb-0 h1 text-light">Bermuda API Docs</span>
    </div>
  </nav>
  <div class="container mt-3">
    <section class="mb-5">
      <h2 class="upper">Auth</h2>
      <ul class="list-group">
        <li class="list-group-item">
          <span class="badge badge-pill badge-info">POST</span>
          <code class="api-url">/api/token</code>
          <div>Get a auth token by username and password, which means you are <u>logging in</u> our system.</div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-info">POST</span>
          <code class="api-url">/api/account/register</code>
          <div>Register by username and password.</div>
        </li>
      </ul>
    </section>
    <section class="mb-5">
      <h2 class="upper">Notice</h2>
      <ul class="list-group">
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/notices</code>
          <div>Get all notices which are not solved. i.e. <a href="/api/notices">all</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/notices{/id}</code>
          <div>Get notice by id. i.e. <a href="/api/notices/1">id=1</a></div>
        </li>
      </ul>
    </section>
    <section class="mb-5">
      <h2 class="upper">Notice Specie</h2>
      <ul class="list-group">
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/notice/species</code>
          <div>Get all notice species. i.e. <a href="/api/notice/species">all</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/notice/species{/id}</code>
          <div>Get notice specie by id. i.e. <a href="/api/notice/species/1">id=1</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/notice/species{/top/count}</code>
          <div>Get notice species top list. i.e. <a href="/api/notice/species/top/5">top/5</a></div>
        </li>
      </ul>
    </section>
    <section class="mb-5">
      <h2 class="upper">Topic</h2>
      <ul class="list-group">
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/topics</code>
          <div>Get all topics. i.e. <a href="/api/topics">all</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/topics{/id}</code>
          <div>Get topic by id. i.e. <a href="/api/topics/1">id=1</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/topics{/type/count}</code>
          <div>Get topics top list with count var. i.e. <a href="/api/topics/top/5">top/5</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-info">POST</span>
          <code class="api-url">/api/topics/create</code>
          <div>Create a topic for authorized user.</div>
        </li>
      </ul>
    </section>
    <section class="mb-5">
      <h2 class="upper">User</h2>
      <ul class="list-group">
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/users{/id}</code>
          <div>Get user by id. i.e. <a href="/api/users/10001">id=10001</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/users/top/{count}</code>
          <div>Get top users with count var. i.e. <a href="/api/users/top/5">top/5</a></div>
        </li>
      </ul>
    </section>
    <section class="mb-5">
      <h2 class="upper">Product</h2>
      <ul class="list-group">
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/products</code>
          <div>Get all products. i.e. <a href="/api/products" target="_blank">all</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/products{/id}</code>
          <div>Get product by id. i.e. <a href="/api/products/1" target="_blank">id=1</a></div>
        </li>
      </ul>
    </section>
    <section class="mb-5">
      <h2 class="upper">Shopping Cart</h2>
      <ul class="list-group">
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <span class="badge badge-pill badge-warning">Auth</span>
          <code class="api-url">/api/cart{/uid}</code>
          <div>Get products of shopping cart by uid(user id). i.e. <a href="/api/cart/10001" target="_blank">uid=10001</a></div>
        </li>
      </ul>
    </section>
    <section class="mb-5">
      <h2 class="upper">Current</h2>
      <ul class="list-group">
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/currents</code>
          <div>Get all currents order by `created_at`. i.e. <a href="/api/currents" target="_blank">all</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/currents{/id}</code>
          <div>Get current by id. i.e. <a href="/api/currents/1" target="_blank">id=1</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/user{/uid}/currents</code>
          <div>Get currents by `user_id`. i.e. <a href="/api/user/10001/currents" target="_blank">uid=10001</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/topic{/tid}/currents</code>
          <div>Get currents of joining topic id equals `tid`. i.e. <a href="/api/topic/2/currents" target="_blank">tid=2</a></div>
        </li>
      </ul>
    </section>

    <section class="mb-5">
      <h2 class="upper">Search</h2>
      <ul class="list-group">
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/search/notices{/q}}</code>
          <div>Search notices. i.e. <a href="/api/search/notices/test">q=test</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/search/users{/q}}</code>
          <div>Search users. i.e. <a href="/api/search/users/test">q=test</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/search/topics{/q}}</code>
          <div>Search topics. i.e. <a href="/api/search/topics/test">q=test</a></div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-primary">GET</span>
          <code class="api-url">/api/search/currents{/q}}</code>
          <div>Search currents. i.e. <a href="/api/search/currents/test">q=test</a></div>
        </li>
      </ul>
    </section>
    <section class="mb-5">
      <h2 class="upper">File</h2>
      <ul class="list-group">
        <li class="list-group-item">
          <span class="badge badge-pill badge-info">POST</span>
          <code class="api-url">/api/files/img/upload</code>
          <div>Upload image. Example in playground.</div>
        </li>
        <li class="list-group-item">
          <span class="badge badge-pill badge-danger">Delete</span>
          <code class="api-url">/api/files/img/delete</code>
          <div>Delete image that uploaded to server just now.</div>
        </li>
      </ul>
    </section>

    <h3>Playgroud</h3>
    <div class="py-3">
      <h4>testing upload img</h4>
      <div class="form-group">
        <input type="file" name="img"/>
      </div>
      <button id="upload-img" class="btn btn-info">upload</button>
      <div class="img-preview my-3"></div>
    </div>

    <h4>How use wangEditor</h4>
    <div id="editor">
      <p>欢迎使用 <b>wangEditor</b> 富文本编辑器</p>
    </div>
    <script src="https://unpkg.com/wangeditor/release/wangEditor.min.js"></script>
  </div>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
  <script>
    // testing get notice by page index in fetch func
    //fetch('http://localhost:53595/api/home')
    //  .then(res => res.json())
    //  .then(data => {
    //    console.log(data)
    //  })
    //  .catch(err => console.log(err));

    const uploadImgBtn = document.querySelector('#upload-img');
    const fileInput = document.querySelector('input[type=file]');
    const imgPreview = document.querySelector('.img-preview');
    let fd = null

    function onFileSelected(e) {
      e.preventDefault();
      fd = e.target.files[0];
      console.log(e.target.files)
      //let img = new FormData();
      //img.append('img', fd);
      //$.ajax({
      //  type: 'POST',
      //  url: '/api/files/upload',
      //  data: img,
      //  processData: false,
      //  contentType: false,
      //  success: (data) => {
      //    imgPreview.innerHTML = `
      //      <img src="${data}" alt="img preview" width="256">
      //    `
      //  }
      //})
    }

    function onUploadImg(e) {
      e.preventDefault();

      let img = new FormData();
      img.append('img', fd);

      $.ajax({
        type: 'POST',
        url: '/api/files/img/upload_for_editor',
        data: img,
        processData: false,
        contentType: false,
        success: (data) => {
          console.log(data)
          //imgPreview.innerHTML = `
          //  <img src="${data.url}" alt="img preview" width="256">
          //`
        }
      })
    }

    fileInput.addEventListener('change', onFileSelected);
    uploadImgBtn.addEventListener('click', onUploadImg);

    // create a wangEditor
    var E = window.wangEditor
    var editor = new E('#editor')
    editor.customConfig.uploadImgServer = '/api/files/img/upload_for_editor'
    editor.create()
  </script>
</body>
</html>
